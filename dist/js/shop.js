"use strict";$(function(){$(".header").load("header1.html"),$(".footer").load("footer.html"),function(){if(localStorage.shop){var o="",s=0,p=JSON.parse(localStorage.shop);$.get("../json/All.json",function(t){var e=0;for(var n in p)e++;for(var i=0;i<t.length;i++)for(var a in p){var r=a.split("?")[1];t[i].gid==r&&(o+='<li>\n\t\t\t\t\t\t\t\t\t\t<input type="checkbox" name="" class="radio" value="" checked="checked"/>\n\t\t\t\t\t\t\t\t\t\t<a href="##"><img src="'+t[i].photo+'" data-id="'+t[i].gid+'"/></a>\n\t\t\t\t\t\t\t\t\t\t<p>'+t[i].subject+'</p>\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<input type="button" id="reduce" value="-" readonly="readonly"/>\n\t\t\t\t\t\t\t\t\t\t\t<input type="text" name="num" id="num" value="'+p[a]+'" readonly="readonly"/>\n\t\t\t\t\t\t\t\t\t\t\t<input type="button" id="add" value="+" readonly="readonly"/>\n\t\t\t\t\t\t\t\t\t\t\t<p>有货</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<p>￥<span class="pirce1">'+(parseInt(p[a])*parseFloat(t[i].sale_price)).toFixed(2)+'</span></p>\n\t\t\t\t\t\t\t\t\t\t\t<p>￥<span class="pirce2">'+t[i].sale_price+"</span>/"+t[i].unit+'</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t\t<a href="##" class="share">[收藏] </a>\n\t\t\t\t\t\t\t\t\t\t\t<a href="##" class="delete">[删除]</a>\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t</li>',s+=Number((parseInt(p[a])*parseFloat(t[i].sale_price)).toFixed(2)))}$(".shop2").html(o),$(".settlement2").find("strong").find("span").html(s.toFixed(2)),$(".settlement2").find("a").find("span").html(e),$(".radio").click(function(){var t=0,e=0;$(".radio").each(function(){if(0==$(this).prop("checked"))return $("#select").prop("checked",!1),!1;$("#select").prop("checked",!0)}),$(".radio").each(function(){$(this).prop("checked")&&(t+=parseFloat($(this).parent().find(".pirce1").html()),e++)}),$(".settlement2").find("strong").find("span").html(t.toFixed(2)),$(".settlement2").find("a").find("span").html(e)}),$("#select").click(function(){var t=0,e=0;$(this).prop("checked")?$(".radio").each(function(){t++,e+=parseFloat($(this).parent().find(".pirce1").html()),$(this).prop("checked",!0)}):$(".radio").each(function(){$(this).prop("checked",!1)}),$(".settlement2").find("strong").find("span").html(e.toFixed(2)),$(".settlement2").find("a").find("span").html(t)}),function(){var p=$(".settlement").offset().top+parseInt($(".settlement").css("height"));function d(){var t=document.documentElement.clientHeight,e=document.documentElement.clientWidth;p>t+$(document).scrollTop()?$(".settlement").css({position:"fixed",bottom:0,width:e,margin:0,background:"#fff",zIndex:"100","box-shadow":"1px 1px 3px 1px"}):$(".settlement").css({position:"none",background:"#f5f5f5",width:"1200px",margin:"10px auto","box-shadow":"none"}),$(document).scroll(function(){t=document.documentElement.clientHeight,p>t+$(document).scrollTop()?$(".settlement").css({position:"fixed",bottom:0,width:e,margin:0,background:"#fff",zIndex:"100","box-shadow":"1px 1px 3px 1px"}):$(".settlement").css({position:"none",background:"#f5f5f5",width:"1200px",margin:"10px auto","box-shadow":"none"})})}$(".shop2").on("click","#reduce",function(){var t=parseFloat($(this).parent().parent().find(".pirce2").html()),e=parseInt($(this).next().val());if(e<=1?e=1:e--,$(this).next().val(e),$(this).parent().parent().find(".pirce1").html((t*e).toFixed(2)),$(this).parent().parent().find(".radio").prop("checked")){var n=parseFloat($(this).parent().parent().find(".pirce1").html());$(this).parent().parent().siblings().find(".pirce1").each(function(t,e){n+=parseFloat(e.innerHTML)}),$(".settlement2").find("strong").find("span").html(n.toFixed(2))}}),$(".shop2").on("click","#add",function(){var t=parseFloat($(this).parent().parent().find(".pirce2").html()),e=parseInt($(this).prev().val());if(e++,$(this).prev().val(e),$(this).parent().parent().find(".pirce1").html((t*e).toFixed(2)),$(this).parent().parent().find(".radio").prop("checked")){var n=parseFloat($(this).parent().parent().find(".pirce1").html());$(this).parent().parent().siblings().find(".pirce1").each(function(t,e){n+=parseFloat(e.innerHTML)}),$(".settlement2").find("strong").find("span").html(n.toFixed(2))}}),d(),$(".delete").click(function(){var t=parseInt($(this).parent().parent().css("height"));$(this).parent().parent().remove();var e=$(this).parent().parent().find("img").attr("data-id"),n=JSON.parse(localStorage.shop),i={},a=0,r=0;for(var o in n)e!=o.split("?")[1]&&(i[o]=n[o]);for(var s in i)a++;$(".radio").each(function(){$(this).prop("checked")&&(r+=parseFloat($(this).parent().find(".pirce1").html()))}),$(".settlement2").find("strong").find("span").html(r.toFixed(2)),$(".settlement2").find("a").find("span").html(a),$(".box3-1").children().last().find("span").html(a),$(".shopnum").html(a),localStorage.shop=JSON.stringify(i),p-=t,d()}),$(".settlement1").find("a").eq(0).click(function(){var s=0;$(".radio").each(function(){if($(this).prop("checked")){s+=parseInt($(this).parent().css("height")),$(this).parent().remove();var t=$(this).parent().find("img").attr("data-id"),e=JSON.parse(localStorage.shop),n={},i=0,a=0;for(var r in e)t!=r.split("?")[1]&&(n[r]=e[r]);for(var o in n)i++;$(".radio").each(function(){$(this).prop("checked")&&(a+=parseFloat($(this).parent().find(".pirce1").html()))}),$(".settlement2").find("strong").find("span").html(a.toFixed(2)),$(".settlement2").find("a").find("span").html(i),$(".box3-1").children().last().find("span").html(i),$(".shopnum").html(i),localStorage.shop=JSON.stringify(n)}}),p-=s,d()})}()})}}()});